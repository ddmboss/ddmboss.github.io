<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
    <title>WordPress Docker Development Set-Up with Traefik, Redis, and Nginx | ddmboss</title>
    <meta name="description" content="Live, Love, Laugh, Learn" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    <link rel="stylesheet" href="https://www.ddmboss.com/style.main.min.c34e6915a95f1027dad7b48e5d1ff6e2bbf58b4e72c69d7ec6ac8e7352e961dc.css" />

</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
            <a class="site-nav-logo" href="https://www.ddmboss.com/">ddmboss</a>
        
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="/about/">About</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/posts/">Blog</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/tags/">Tags</a></li>
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/docker">Docker</a>
                    </section>
                

                <h1 class="post-full-title">WordPress Docker Development Set-Up with Traefik, Redis, and Nginx</h1>

                
                    <p class="post-full-custom-excerpt">Hey there, today I am going to walk you through setting up a WordPress Development using Docker, Traefik, Redis and Nginx.</p>
                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>Delano Maloney</h2>
                </div>
            </div>
        </div>
        <a href="#" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">Delano Maloney</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2022-11-01">19 January 2022</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 6 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            
            <figure class="post-full-image">
                <img src="/uploads/posts/wordpress-docker.png" alt="WordPress Docker Development Set-Up with Traefik, Redis, and Nginx" />
            </figure>
            

            <section class="post-full-content">
                <div class="post-content">
                    <p>So first up lets get <strong>Traefik</strong> set-up so that we can give all our public services a domain to make it easier to access.</p>
<p>Create a new <strong>docker-compose.yml</strong> file in an empty folder and paste the following</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.8&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">traefik</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">traefik:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">80</span>:<span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">443</span>:<span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>:
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">accesslog</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">log.level=INFO</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">api.dashboard=true</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">api.insecure=true</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">providers.docker=true</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">providers.docker.exposedbydefault=false</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">entrypoints.web.address=:80</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">entrypoints.web-secure.address=:443</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.tlschallenge=true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.caserver=https://acme-staging-v02.api.letsencrypt.org/directory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.email=admin@wpdev.test</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/var/run/docker.sock:/var/run/docker.sock</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik:/letsencrypt</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.enable=true</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.api.rule=Host(`${TRAEFIK_URL}`)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.api.entrypoints=web</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.api.service=api@internal</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.services.traefik.loadbalancer.server.port=8080</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.api.entrypoints=web-secure</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.api.tls=true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.api.tls.certresolver=letsencrypt</span>
</span></span></code></pre></div><p>If you&rsquo;ve looked at my previous post on WordPress and Traefik, this Traefik configuration script is essentially the same.</p>
<p>Next up configuring <strong>WordPress</strong>, WordPress by default works with Apache webserver, now while that setup isn&rsquo;t much of a problem for very small sites, as your website grows and gets bulkier you&rsquo;ll soon realize you need a bit more performance, thus <strong>Nginx</strong>.</p>
<p>First inside the same folder we just created for the <strong>docker-compose.yml</strong> file, create a new folder called <strong>nginx</strong>, and inside the <strong>nginx</strong> folder create another folder called <strong>conf</strong>, inside the <strong>conf</strong> folder create a new file called <strong>default.conf</strong></p>
<p>Inside the <strong>default.conf</strong> file add the following:</p>
<pre tabindex="0"><code class="language-CONF" data-lang="CONF"># Upstream to abstract backend connection(s) for php
upstream php {
        #server unix:/var/run/php/php-cgi.socket;
        server wordpress:9000;
}

server {
        ## Your website name goes here.
        server_name localhost;
        ## Your only path reference.
        root /var/www/html;
        ## This should be in your http block and if it is, it&#39;s not needed here.
        index index.php;

        access_log /var/log/nginx/access.log;
        error_log /var/log/nginx/error.log;

        location = /favicon.ico {
                log_not_found off;
                access_log off;
        }

        location = /robots.txt {
                allow all;
                log_not_found off;
                access_log off;
        }

        # Deny all attempts to access hidden files such as .htaccess, .htpasswd, .DS_Store (Mac).
        location ~ /\. {
            deny all;
        }
        
        # Deny access to any files with a .php extension in the uploads directory
        # Works in sub-directory installs and also in multisite network
        location ~* /(?:uploads|files)/.*\.php$ {
            deny all;
        }

        location / {
                # This is cool because no php is touched for static content.
                # include the &#34;?$args&#34; part so non-default permalinks doesn&#39;t break when using query string
                try_files $uri $uri/ /index.php?$args;
        }

        location ~ \.php$ {
                #NOTE: You should have &#34;cgi.fix_pathinfo = 0;&#34; in php.ini
                include fastcgi_params;
                fastcgi_intercept_errors on;
                fastcgi_pass php;
                #The following parameter can be also included in fastcgi_params file
                fastcgi_param  SCRIPT_FILENAME $document_root$fastcgi_script_name;
        }

        # Caching of media: images, icons, video, audio
        location ~* \.(jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc|woff|woff2)$ {
                expires max;
                log_not_found off;
        }

        # CSS and JavaScript
        location ~* \.(css|js)$ {
                expires max;
                log_not_found off;
        }
}
</code></pre><p>Next reopen the <strong>docker-compose.yml</strong> file and add:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">nginx</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">wordpress</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./nginx/conf:/etc/nginx/conf.d</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./nginx/logs:/var/log/nginx</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./wordpress:/var/www/html</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.enable=true</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.wordpress.rule=Host(`${WP_URL}`, `${WP_WWW_URL}`)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.wordpress.entrypoints=web</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress.middlewares=redirect-to-https@docker</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress-secure.rule=Host(`${WP_URL}`, `${WP_WWW_URL}`)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress-secure.entrypoints=web-secure</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress-secure.tls.certresolver=letsencrypt</span>
</span></span></code></pre></div><p>Now lets configure <strong>WordPress</strong>, because we are setting WordPress up to use Nginx, we must specify the version of the WordPress image tag for docker to use, rather than simply putting latest. On the <a href="https://hub.docker.com/_/wordpress">WordPress Docker Hub</a> page, the images that support Nginx would be denoted with <strong>fpm</strong> in the name.</p>
<p>In the existing <strong>docker-compose.yml</strong> file add:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">wordpress</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">wordpress:php8.0-fpm-alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">9000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_HOST</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_NAME</span>: <span style="color:#ae81ff">${WP_DB_NAME}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_USER</span>: <span style="color:#ae81ff">${WP_DB_USER}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_PASSWORD</span>: <span style="color:#ae81ff">${WP_DB_PASSWORD}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_TABLE_PREFIX</span>: <span style="color:#ae81ff">${WP_DB_PREFIX}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_CONFIG_EXTRA</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;WP_REDIS_HOST&#39;, &#39;redis&#39; );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;WP_REDIS_PORT&#39;, 6379 );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;COMPRESS_CSS&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;COMPRESS_SCRIPTS&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;CONCATENATE_SCRIPTS&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;ENFORCE_GZIP&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;AUTOSAVE_INTERVAL&#39;, 120 );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;WP_POST_REVISIONS&#39;, 10);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;MEDIA_TRASH&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;EMPTY_TRASH_DAYS&#39;, 30 );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;IMAGE_EDIT_OVERWRITE&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;DISALLOW_FILE_EDIT&#39;, true );</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./wordpress:/var/www/html</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./wordpress.ini:/usr/local/etc/php/conf.d/wordpress.ini</span>
</span></span></code></pre></div><p>The biggest change is the default port on which <strong>WordPress</strong> responds, which defaults to port <strong>9000</strong></p>
<p>Next create a file <strong>wordpress.ini</strong> next to the <strong>docker-compose.yml</strong> file and add:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-INI" data-lang="INI"><span style="display:flex;"><span><span style="color:#a6e22e">file_uploads</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">On</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">upload_max_filesize</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">128M</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">post_max_size</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">128M</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">memory_limit</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">256M</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">max_execution_time</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">60</span>
</span></span></code></pre></div><p>Next up <strong>MariaDB</strong> and <strong>Adminer</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">mariadb</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mariadb:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">3306</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_DATABASE</span>: <span style="color:#ae81ff">${WP_DB_NAME}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_USER</span>: <span style="color:#ae81ff">${WP_DB_USER}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_PASSWORD</span>: <span style="color:#ae81ff">${WP_DB_PASSWORD}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_RANDOM_ROOT_PASSWORD</span>: <span style="color:#e6db74">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mariadb:/var/lib/mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">adminer</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">adminer:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.enable=true</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.adminer.rule=Host(`${ADMINER_URL}`)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.adminer.entrypoints=web</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer.middlewares=redirect-to-https@docker</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer-secure.rule=Host(`${ADMINER_URL}`)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer-secure.entrypoints=web-secure</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer-secure.tls.certresolver=letsencrypt</span>
</span></span></code></pre></div><p>Then we set up <strong>Redis</strong> to cache database queries, so add the following to your <strong>docker-compose.yml</strong> file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">redis</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">redis:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">6379</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis-server</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">save 60 1 </span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">loglevel warning</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">maxmemory 128mb </span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">maxmemory-policy allkeys-lru </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis:/var/lib/redis</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis:/data</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- ./redis.conf:/usr/local/etc/redis/redis.conf</span>
</span></span></code></pre></div><p>I covered how to get WordPress setup with Redis in my <a href="https://www.ddmboss.com/2022/01/02/how-to-setup-an-advanced-wordpress-development-environment-with-docker-traefik-and-redis/">previous post</a></p>
<p>Finally we create a <strong>.env</strong> file to store any variables set in the <strong>docker-compose.yml</strong> file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-SH" data-lang="SH"><span style="display:flex;"><span><span style="color:#75715e"># WordPress</span>
</span></span><span style="display:flex;"><span>WP_DB_NAME<span style="color:#f92672">=</span>wp-dev-db
</span></span><span style="display:flex;"><span>WP_DB_PREFIX<span style="color:#f92672">=</span>wp_
</span></span><span style="display:flex;"><span>WP_DB_USER<span style="color:#f92672">=</span>wp-dev-user
</span></span><span style="display:flex;"><span>WP_DB_PASSWORD<span style="color:#f92672">=</span>wp-dev-pass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Traefik Domains</span>
</span></span><span style="display:flex;"><span>WP_URL<span style="color:#f92672">=</span>wpdev.test
</span></span><span style="display:flex;"><span>WP_WWW_URL<span style="color:#f92672">=</span>www.wpdev.test
</span></span><span style="display:flex;"><span>TRAEFIK_URL<span style="color:#f92672">=</span>traefik.wpdev.test
</span></span><span style="display:flex;"><span>ADMINER_URL<span style="color:#f92672">=</span>adminer.wpdev.test
</span></span></code></pre></div><p>At the end your <strong>docker-compose.yml</strong> file should look similar to this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-YAML" data-lang="YAML"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3.8&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">traefik</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">traefik:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">80</span>:<span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">443</span>:<span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>:
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">accesslog</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">log.level=INFO</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">api.dashboard=true</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">api.insecure=true</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">providers.docker=true</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">providers.docker.exposedbydefault=false</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">entrypoints.web.address=:80</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">entrypoints.web-secure.address=:443</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.tlschallenge=true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.caserver=https://acme-staging-v02.api.letsencrypt.org/directory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.email=admin@wpdev.test</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- --certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/var/run/docker.sock:/var/run/docker.sock</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik:/letsencrypt</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.enable=true</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.api.rule=Host(`${TRAEFIK_URL}`)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.api.entrypoints=web</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.api.service=api@internal</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.services.traefik.loadbalancer.server.port=8080</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.api.entrypoints=web-secure</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.api.tls=true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.api.tls.certresolver=letsencrypt</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">nginx</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx:alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">wordpress</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./nginx/conf:/etc/nginx/conf.d</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./nginx/logs:/var/log/nginx</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./wordpress:/var/www/html</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.enable=true</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.wordpress.rule=Host(`${WP_URL}`, `${WP_WWW_URL}`)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.wordpress.entrypoints=web</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress.middlewares=redirect-to-https@docker</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress-secure.rule=Host(`${WP_URL}`, `${WP_WWW_URL}`)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress-secure.entrypoints=web-secure</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.wordpress-secure.tls.certresolver=letsencrypt</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">wordpress</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">wordpress:php8.0-fpm-alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">9000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_HOST</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_NAME</span>: <span style="color:#ae81ff">${WP_DB_NAME}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_USER</span>: <span style="color:#ae81ff">${WP_DB_USER}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_DB_PASSWORD</span>: <span style="color:#ae81ff">${WP_DB_PASSWORD}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_TABLE_PREFIX</span>: <span style="color:#ae81ff">${WP_DB_PREFIX}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">WORDPRESS_CONFIG_EXTRA</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;WP_REDIS_HOST&#39;, &#39;redis&#39; );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;WP_REDIS_PORT&#39;, 6379 );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;COMPRESS_CSS&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;COMPRESS_SCRIPTS&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;CONCATENATE_SCRIPTS&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;ENFORCE_GZIP&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;AUTOSAVE_INTERVAL&#39;, 120 );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;WP_POST_REVISIONS&#39;, 10);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;MEDIA_TRASH&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;EMPTY_TRASH_DAYS&#39;, 30 );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;IMAGE_EDIT_OVERWRITE&#39;, true );</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">define( &#39;DISALLOW_FILE_EDIT&#39;, true );</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./wordpress:/var/www/html</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./wordpress.ini:/usr/local/etc/php/conf.d/wordpress.ini</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mariadb</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mariadb:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">3306</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_DATABASE</span>: <span style="color:#ae81ff">${WP_DB_NAME}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_USER</span>: <span style="color:#ae81ff">${WP_DB_USER}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_PASSWORD</span>: <span style="color:#ae81ff">${WP_DB_PASSWORD}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_RANDOM_ROOT_PASSWORD</span>: <span style="color:#e6db74">&#39;1&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mariadb:/var/lib/mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">adminer</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">adminer:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">depends_on</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">labels</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.enable=true</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.adminer.rule=Host(`${ADMINER_URL}`)</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">traefik.http.routers.adminer.entrypoints=web</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer.middlewares=redirect-to-https@docker</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer-secure.rule=Host(`${ADMINER_URL}`)</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer-secure.entrypoints=web-secure</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- traefik.http.routers.adminer-secure.tls.certresolver=letsencrypt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">redis</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">redis:alpine</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">6379</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">command</span>: 
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis-server</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">save 60 1 </span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">loglevel warning</span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">maxmemory 128mb </span>
</span></span><span style="display:flex;"><span>      - --<span style="color:#ae81ff">maxmemory-policy allkeys-lru </span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis:/var/lib/redis</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">redis:/data</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">#- ./redis.conf:/usr/local/etc/redis/redis.conf</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">traefik</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mariadb</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">redis</span>:
</span></span></code></pre></div><p>Once finished you can Setup WordPress using the URL set in the <strong>.env</strong> file and everything should load up as usual.</p>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/docker">Docker</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>
<article class="post-card post


 ">

        
            <a class="post-card-image-link" href="https://www.ddmboss.com/posts/advanced-wordpress-development-environment-with-docker-traefik-and-redis/">
                <img class="post-card-image"src="/uploads/posts/wordpress-docker.png" alt="Advanced WordPress Development Environment with Docker, Traefik, and Redis"/>
            </a>
        
    
        <div class="post-card-content">
    
            <a class="post-card-content-link" href="https://www.ddmboss.com/posts/advanced-wordpress-development-environment-with-docker-traefik-and-redis/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Docker</div>
                    

                    <h2 class="post-card-title">Advanced WordPress Development Environment with Docker, Traefik, and Redis</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>Hey there, today I&rsquo;m going to walk you through how to setup an advanced WordPress development environment, using Docker, Traefik, and Redis.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <ul class="author-list">
                        <li class="author-list-item">
                            <div class="author-name-tooltip">Delano Maloney</div>
                            <a href="#" class="static-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
                        </li>
                    </ul>
                    <div class="post-card-byline-content">
                        <span>Delano Maloney</span>
                        <span class="post-card-byline-date"><time datetime="2022-31-01">2 January 2022</time>
                            <span class="bull">&bull;</span> 5 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    

            
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://www.ddmboss.com/">ddmboss</a> &copy; 2022</section>
                <nav class="site-footer-nav">
                    <a href="https://www.ddmboss.com/">Latest Posts</a>
                    
                    <a href="https://twitter.com/ddmboss" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://github.com/ddmboss" target="_blank" rel="noopener">Github</a>
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3</a>
                </nav>
            </div>
        </footer>

    </div>

</body>
</html>
